/**
 * JuiceSlider
 * @author 4ward.media GbR <http://www.4wardmedia.de>
 * @licence LGPL
 */

var JuiceSLider=new Class({Implements:[Options],options:{closedWidth:50,initialExpand:-1,hideToggler:true,fxDuration:500,fxTransition:"quad:in:out"},container:null,items:[],initialize:function(container,options){this.container=container;this.setOptions(options);var elems=this.container.getChildren();this.itemWidth=this.container.getSize().x-elems.length*this.options.closedWidth;elems.each(function(el,index){var classes="juiceSliderItem";classes+=" juiceSliderItem"+index;if(index==0){classes+=" first";}if(index==elems.length-1){classes+=" last";}this.items[index]=new Element("div",{"class":classes}).wraps(el);}.bind(this));this.items=new Elements(this.items);var pad=this.container.getElement(".juiceSliderItem div").getStyles("padding-left","padding-right");var innerWidth=this.itemWidth-pad["padding-left"].toInt()-pad["padding-right"].toInt();elems.each(function(el,index){el.setStyle("width",innerWidth);}.bind(this));this.items.setStyles({height:"100%",overflow:"hidden","float":"left",position:"relative",width:this.options.closedWidth});this.items.each(function(el,index){el.addEvents({mouseenter:function(){el.addClass("hover");},mouseleave:function(){el.removeClass("hover");}});new Element("div",{"class":"juiceSliderToggler",events:{click:function(){this.expand(index);}.bind(this)},styles:{width:this.options.closedWidth,height:"100%",position:"absolute",top:0,left:0}}).inject(el,"top");}.bind(this));var url=new URI(document.location.href);if(url.getData("juiceSlider")){this.expand(url.getData("juiceSlider"));}if(this.options.initialExpand==-1){this.expand(this.items.length-1);}else{if(this.options.initialExpand===false){}else{this.expand(this.options.initialExpand);}}},expand:function(index){if(this.items[index].getStyle("width").toInt()>this.options.closedWidth){return;}this.items.removeClass("active");this.items[index].addClass("active");if(this.options.hideToggler){this.items.getElements(".juiceSliderToggler").each(function(el,togglerIndex){if(togglerIndex==index){el.morph({opacity:0,width:0});}else{el.morph({opacity:1,width:this.options.closedWidth});}}.bind(this));}var effectMatrix={};for(var i=0;i<this.items.length;i++){effectMatrix[i]={width:(i==index)?this.itemWidth:this.options.closedWidth};}var effect=new Fx.Elements(this.items,{duration:this.options.fxDuration,transition:this.options.fxTransition});effect.start(effectMatrix);}});